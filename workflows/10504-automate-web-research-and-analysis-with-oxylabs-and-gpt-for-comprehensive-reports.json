{
  "id": "gMzDLbWDEWN25K1B",
  "meta": {
    "instanceId": "de8769960d4a63628a297c524a1f14342a1b89b5454373593bc8ad924e52c218",
    "templateCredsSetupCompleted": true
  },
  "name": "Deep Research AI Workflow",
  "tags": [],
  "nodes": [
    {
      "id": "19c69628-1f55-4d68-8e56-772944f34364",
      "name": "When chat message received",
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "position": [
        -1600,
        -608
      ],
      "webhookId": "a5ea9aa7-a977-4976-aeb2-e781fc863097",
      "parameters": {
        "options": {}
      },
      "typeVersion": 1.3
    },
    {
      "id": "c6c2aa0e-9cff-4d0a-b31c-f9c4ea6db0e9",
      "name": "Search Google",
      "type": "n8n-nodes-oxylabs-ai-studio.oxylabsAiStudio",
      "position": [
        -592,
        -608
      ],
      "parameters": {
        "resource": "search",
        "searchQuery": "={{ $json.query }}",
        "searchReturnContent": false
      },
      "retryOnFail": true,
      "typeVersion": 1,
      "waitBetweenTries": 1000
    },
    {
      "id": "bb3d5b5d-2abf-496e-a938-863eb52624b2",
      "name": "Split URLs",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        -32,
        -608
      ],
      "parameters": {
        "options": {
          "destinationFieldName": "url"
        },
        "fieldToSplitOut": "output[0].content[0].text.urls"
      },
      "typeVersion": 1
    },
    {
      "id": "97906431-1112-4e73-be2c-96e84da73e83",
      "name": "Split queries",
      "type": "n8n-nodes-base.splitOut",
      "position": [
        -1056,
        -608
      ],
      "parameters": {
        "options": {
          "destinationFieldName": "query"
        },
        "fieldToSplitOut": "output[0].content[0].text.queries"
      },
      "typeVersion": 1
    },
    {
      "id": "0dd51017-aa19-4450-b21b-20b9e8c0627c",
      "name": "Get number of URLs",
      "type": "n8n-nodes-base.set",
      "position": [
        -672,
        -32
      ],
      "parameters": {
        "options": {},
        "assignments": {
          "assignments": [
            {
              "id": "d55ad15b-5d31-4103-b2b5-c9d0158c7558",
              "name": "length",
              "type": "string",
              "value": "={{ $('Split URLs').all().length }}"
            }
          ]
        }
      },
      "executeOnce": true,
      "typeVersion": 3.4
    },
    {
      "id": "cc234eec-2262-4160-8ee1-cf9f18e1ab3e",
      "name": "Get all data",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        464,
        -352
      ],
      "parameters": {
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "list",
          "value": "ZNXGefBcwkYYdyDE",
          "cachedResultUrl": "/projects/jsKya8bKmDGhXtT2/datatables/ZNXGefBcwkYYdyDE",
          "cachedResultName": "Content summaries"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "1c008662-12b8-4145-aed6-b24616a91cfe",
      "name": "Get current data for polling",
      "type": "n8n-nodes-base.dataTable",
      "maxTries": 5,
      "position": [
        -448,
        -32
      ],
      "parameters": {
        "operation": "get",
        "returnAll": true,
        "dataTableId": {
          "__rl": true,
          "mode": "list",
          "value": "ZNXGefBcwkYYdyDE",
          "cachedResultUrl": "/projects/jsKya8bKmDGhXtT2/datatables/ZNXGefBcwkYYdyDE",
          "cachedResultName": "Content summaries"
        }
      },
      "executeOnce": false,
      "notesInFlow": false,
      "retryOnFail": false,
      "typeVersion": 1,
      "alwaysOutputData": false,
      "waitBetweenTries": 5000
    },
    {
      "id": "bd2bff1d-8cf9-4667-9fff-b5c1b0c48bf0",
      "name": "If all data exists",
      "type": "n8n-nodes-base.if",
      "position": [
        -64,
        -128
      ],
      "parameters": {
        "options": {},
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "loose"
          },
          "combinator": "or",
          "conditions": [
            {
              "id": "9b2069cc-152e-490e-8c87-3687f24d350c",
              "operator": {
                "type": "number",
                "operation": "equals"
              },
              "leftValue": "={{ $json.id.last() }}",
              "rightValue": "={{ $('Get number of URLs').item.json.length }}"
            }
          ]
        },
        "looseTypeValidation": true
      },
      "executeOnce": false,
      "typeVersion": 2.2
    },
    {
      "id": "77e48b58-c1b4-4735-a94b-c0de90b63264",
      "name": "Extract IDs",
      "type": "n8n-nodes-base.aggregate",
      "position": [
        -288,
        -32
      ],
      "parameters": {
        "options": {},
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "id"
            }
          ]
        }
      },
      "typeVersion": 1
    },
    {
      "id": "8a40511d-91a2-4957-ab69-cf79d4003a85",
      "name": "Wait 60s",
      "type": "n8n-nodes-base.wait",
      "position": [
        -912,
        80
      ],
      "webhookId": "18e044ce-5518-45e1-9828-8405432614e0",
      "parameters": {
        "amount": 60
      },
      "typeVersion": 1.1
    },
    {
      "id": "620953f0-1a54-4872-9e9d-4ce7c17306ab",
      "name": "Wait 10s",
      "type": "n8n-nodes-base.wait",
      "position": [
        -80,
        128
      ],
      "webhookId": "a109b907-16d0-4d05-be48-cc751368e4ca",
      "parameters": {
        "amount": 10
      },
      "typeVersion": 1.1
    },
    {
      "id": "414592cc-96c3-4fbb-9470-cb3a01c5e005",
      "name": "Sticky Note",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1744,
        -784
      ],
      "parameters": {
        "color": 7,
        "width": 960,
        "height": 448,
        "content": "# ðŸ”Ž  STEP 1: Create Google search queries\nSubmit your message/questions, automatically create strategic Google Search queries, and make them ready for processing."
      },
      "typeVersion": 1
    },
    {
      "id": "6bcd86e7-d000-4cf6-8640-39d951e8ade7",
      "name": "Sticky Note1",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -720,
        -784
      ],
      "parameters": {
        "color": 7,
        "width": 960,
        "height": 448,
        "content": "# ðŸ“Œ  STEP 2: Scrape Google & pick relevant URLs\nScrape Google Search results for each query, select relevant and authoritative sources from all results, and prepare the list of URLs for further processing."
      },
      "typeVersion": 1
    },
    {
      "id": "e93a8f55-340d-4028-aec3-61128ec89aaf",
      "name": "Sticky Note2",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -1744,
        -272
      ],
      "parameters": {
        "color": 7,
        "width": 960,
        "height": 704,
        "content": "# ðŸ“‘  STEP 3: Scrape & summarize content in parallel\n\nScrape content from each URL, summarize it with AI, and save it into a data table. Make sure to convert the 3 nodes below to a sub-workflow and edit its setting to enable parallel execution. **See the setup instructions**."
      },
      "typeVersion": 1
    },
    {
      "id": "1f115c1e-5967-43da-94f7-8aa8d261bdae",
      "name": "Sticky Note3",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -720,
        -272
      ],
      "parameters": {
        "color": 7,
        "width": 960,
        "height": 704,
        "content": "# â³  STEP 4: Wait for data\nCheck the data table whether the last row's ID matches the amount of URLs we've sent to the sub-workflow. If it doesn't, wait for 10 seconds and repeat."
      },
      "typeVersion": 1
    },
    {
      "id": "522dae3b-8d29-42c4-88f9-ef433632d76d",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        304,
        -496
      ],
      "parameters": {
        "color": 7,
        "width": 768,
        "height": 400,
        "content": "# âœ… STEP 5: Create final analysis\nGet all summaries from the data table and analyze everything with AI to produce a comprehensive deep research report."
      },
      "typeVersion": 1
    },
    {
      "id": "dd46a50a-cd4e-4027-90a6-65aba178113b",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        -2384,
        -784
      ],
      "parameters": {
        "width": 576,
        "height": 1216,
        "content": "# âš¡ï¸Ž  Fast Deep Research AI Flow\n\nFully automate **deep research from start to finish**: scrape Google Search results, select relevant sources, scrape & analyze each source in parallel, and generate a comprehensive research report.\n\n\n\n## â“ How it works\n1. **Submit your research questions** through n8nâ€™s chat interface\n2. **AI generates strategic search queries** to explore different angles of your topic\n3. **Oxylabs scrapes Google Search** results for each query\n4. **AI evaluates and selects sources** that are the most relevant and authoritative\n5. **Content extraction runs in parallel** via a sub-workflow as Oxylabs scrapes each source and AI extracts key insights\n6. **Summaries are collected in n8nâ€™s data table** for final processing\n7. **AI synthesizes everything** into a comprehensive research report with actionable insights\n\n\n\n\n##  âš ï¸  Requirements\n1. ðŸ†“ Create a **[free Oxylabs AI Studio key](https://aistudio.oxylabs.io/)** â€“ 1000 credits\n2. ðŸ§  Create **OpenAI API key** â€“ or use Gemini, Claude, or local Ollama models\n\n\n\n## âš™ï¸ Setup\n1. **Install Oxylabs AI Studio** as [shown on this page](https://n8n.io/integrations/oxylabs-ai-studio/)\n2. **Set your API keys**:\n    1.1 Oxylabs AI Studio\n    1.2 OpenAI\n3. **Create a [data table](https://docs.n8n.io/data/data-tables/) inside n8n**\n4. **Select the table name** in each data table node\n5. **Create a sub-workflow**:\n    4.1 Select the 3 nodes (Scrape content, Summarize content, Insert row)\n    4.2 Right-click\n    4.3 Select â€œConvert 3 nodes to sub-workflowâ€\n6. **Edit the sub-workflow settings** for for parallel execution:\n    5.1 Mode: Run once for each item\n    5.2 Options â†’ Add Option â†’ disable â€œWait For Sub-Workflow Completionâ€\n"
      },
      "typeVersion": 1
    },
    {
      "id": "1bd01f7c-b9fc-4d67-b507-289847e73733",
      "name": "Create search queries",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -1392,
        -608
      ],
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-5-mini",
          "cachedResultName": "GPT-5-MINI"
        },
        "options": {
          "textFormat": {
            "textOptions": {
              "type": "json_object",
              "verbosity": "low"
            }
          }
        },
        "responses": {
          "values": [
            {
              "content": "={{ $json.chatInput }}"
            },
            {
              "role": "system",
              "content": "You are a part of a deep research team. Your task is to analyze the user's message and create highly specific Google Search queries that will uncover precise and actionable information.\n\nGuidelines for creating search queries:\n- Include ALL key requirements and constraints from the user's message in your queries\n- Every query MUST include the core topic/goal from the user's message\n- Each query must explore a DIFFERENT angle or aspect of the topic\n- Prioritize specificity over breadth - avoid generic terms\n- Use exact terminology and technical terms when relevant\n- Each query should be 4-8 words to balance specificity with searchability\n\nProvide 3 search queries in a list that together cover the full scope of what needs to be researched."
            }
          ]
        },
        "builtInTools": {}
      },
      "typeVersion": 2
    },
    {
      "id": "1a9586b1-ea59-4d00-bc6c-7d8d618baf86",
      "name": "Pick URLs",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -368,
        -608
      ],
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-5-mini",
          "cachedResultName": "GPT-5-MINI"
        },
        "options": {
          "textFormat": {
            "textOptions": {
              "type": "json_object",
              "verbosity": "low"
            }
          }
        },
        "responses": {
          "values": [
            {
              "content": "={{ JSON.stringify($input.all().flatMap(item => item.json.data || [])) }}"
            },
            {
              "role": "system",
              "content": "=You are a part of a deep research team.\nAnalyze the provided Google SERP results and select up to 10 of the most relevant and trustworthy distinct sources for answering this question:\n\"{{ $('When chat message received').item.json.chatInput }}\"\n\nImportant: The Google SERP results are combined from different searches into a single list. Each search term was distinct:\n{{ $('Create search queries').item.json.output[0].content[0].text.queries }}\n\nEvaluation criteria:\n- Prioritize authoritative sources (official sites, established publications, expert domains)\n- Use the SERP descriptions to assess topical relevance to the user's question\n- Prefer recent, primary sources over aggregators when applicable\n\nReturn only the selected URLs compiled into a single JSON array: {\"urls\": [\"url1\", \"url2\", \"url3\"]}\n\nIf fewer than 10 sources meet the criteria, return only the quality ones."
            }
          ]
        },
        "builtInTools": {}
      },
      "executeOnce": true,
      "typeVersion": 2
    },
    {
      "id": "4ed42a13-6e1e-4ad1-aefe-4008f7e35db6",
      "name": "Scrape content",
      "type": "n8n-nodes-oxylabs-ai-studio.oxylabsAiStudio",
      "position": [
        -1648,
        -96
      ],
      "parameters": {
        "scrapeUrl": "={{ $json.url }}"
      },
      "executeOnce": false,
      "retryOnFail": true,
      "typeVersion": 1
    },
    {
      "id": "dc949f66-e548-4831-9bf2-310bee9d66fb",
      "name": "Insert row",
      "type": "n8n-nodes-base.dataTable",
      "position": [
        -1088,
        -96
      ],
      "parameters": {
        "columns": {
          "value": {
            "summary": "={{ $json.output[0].content[0].text }}"
          },
          "schema": [
            {
              "id": "summary",
              "type": "string",
              "display": true,
              "removed": false,
              "readOnly": false,
              "required": false,
              "displayName": "summary",
              "defaultMatch": false
            }
          ],
          "mappingMode": "defineBelow",
          "matchingColumns": [
            "summary"
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {},
        "dataTableId": {
          "__rl": true,
          "mode": "list",
          "value": "ZNXGefBcwkYYdyDE",
          "cachedResultUrl": "/projects/jsKya8bKmDGhXtT2/datatables/ZNXGefBcwkYYdyDE",
          "cachedResultName": "Content summaries"
        }
      },
      "typeVersion": 1
    },
    {
      "id": "770db89a-da8c-452b-a5d9-e7f24c826578",
      "name": "Summarize content",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        -1440,
        -96
      ],
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-5",
          "cachedResultName": "GPT-5"
        },
        "options": {},
        "responses": {
          "values": [
            {
              "content": "={{ $json.data }}"
            },
            {
              "role": "system",
              "content": "=You are a member of a deep research team and you specificaly focus on extracting relevant information from provided web sources. Analyze the provided Markdown content and extract information relevant to the user's question.\n\nStructure your response in Markdown with these sections:\n\n# Key Findings\nList the main facts, statistics, or claims relevant to the question. Provide as much details as necessary.\n\n# Step-by-Step Instructions (skip if none)\nIf the content includes procedural steps or how-to information, extract them here. Provide as much in detail as necessary.\n\n# Supporting Details\nAdditional context, explanations, or evidence that supports the findings\n\nCRITICAL RULES:\n- Only extract information present in the source - never infer or add external knowledge\n- If the source doesn't address part of the question, state \"Not covered in this source\"\n- Keep extractions concise but preserve key specifics (numbers, dates, technical terms)\n- Use bullet points for clarity\n- Provide a 700-1000 words summary\n\nUser's Question:\n{{ $('Start').item.json.chatInput }}"
            }
          ]
        },
        "builtInTools": {}
      },
      "typeVersion": 2
    },
    {
      "id": "34f21a14-12f8-46da-8c5e-44125accca69",
      "name": "Final analysis",
      "type": "@n8n/n8n-nodes-langchain.openAi",
      "position": [
        704,
        -352
      ],
      "parameters": {
        "modelId": {
          "__rl": true,
          "mode": "list",
          "value": "gpt-5",
          "cachedResultName": "GPT-5"
        },
        "options": {},
        "responses": {
          "values": [
            {
              "content": "={{ JSON.stringify($input.all().flatMap(item => item.json.summary || [])) }}"
            },
            {
              "role": "system",
              "content": "=You are a senior research analyst in a deep research team. Your role is to synthesize multiple content summaries into a comprehensive and actionable final report.\n\n## YOUR TASK\nAnswer this user question using ONLY the provided summaries:\n{{ $('When chat message received').item.json.chatInput }}\n\n## CRITICAL RULES\n- **Use ONLY the provided summaries** - Do not add information from your training data or make assumptions beyond what's explicitly stated in the summaries\n- Maximum 1500 words\n\n## REPORT STRUCTURE\n1. **Executive Summary** - Direct answer and key takeaway (2-3 sentences)\n2. **Main Analysis** - Synthesize findings, identify patterns, consensus views\n3. **Actionable Recommendations** - Specific steps the user can take, prioritized suggestions based on data, clear next actions\n4. **Gaps & Limitations** - Missing information and areas needing more research (short section, max 100 words)\n\n## STYLE GUIDELINES\n- Be concise and direct - avoid fluff or repetition\n- Always use clear HEADINGS and FORMATTING for scanability\n- When sources disagree, present both perspectives fairly\n\n## FORMATTING REQUIREMENTS\nUse RICH Markdown formatting for readability:\n- H1, H2, H3, H4 headings to structure content\n- Bold text for emphasis on key findings\n- Tables for comparisons or structured data\n- Bullet lists and numbered lists when appropriate\n- inline code and code blocks where relevant\n- Keep paragraphs concise"
            }
          ]
        },
        "builtInTools": {}
      },
      "executeOnce": true,
      "typeVersion": 2
    }
  ],
  "active": false,
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "6873096c-f33a-473d-9abf-8b09b6b717be",
  "connections": {
    "Wait 10s": {
      "main": [
        [
          {
            "node": "Get current data for polling",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait 60s": {
      "main": [
        [
          {
            "node": "Get number of URLs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Pick URLs": {
      "main": [
        [
          {
            "node": "Split URLs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Insert row": {
      "main": [
        [
          {
            "node": "Wait 60s",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split URLs": {
      "main": [
        [
          {
            "node": "Scrape content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract IDs": {
      "main": [
        [
          {
            "node": "If all data exists",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get all data": {
      "main": [
        [
          {
            "node": "Final analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Search Google": {
      "main": [
        [
          {
            "node": "Pick URLs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split queries": {
      "main": [
        [
          {
            "node": "Search Google",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Scrape content": {
      "main": [
        [
          {
            "node": "Summarize content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summarize content": {
      "main": [
        [
          {
            "node": "Insert row",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get number of URLs": {
      "main": [
        [
          {
            "node": "Get current data for polling",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If all data exists": {
      "main": [
        [
          {
            "node": "Get all data",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Wait 10s",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create search queries": {
      "main": [
        [
          {
            "node": "Split queries",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        [
          {
            "node": "Create search queries",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get current data for polling": {
      "main": [
        [
          {
            "node": "Extract IDs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  }
}